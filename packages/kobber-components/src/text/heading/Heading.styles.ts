import { css, unsafeCSS } from "lit";
import {
  headingTokens,
  headingName,
  headingColors,
  headingSizes,
  headingFonts,
  headingColorVariants,
} from "./Heading.core";
import { resetMargin } from "../../base/styles/reset.styles";
import {
  defaultTypographyStyles,
  setTypographyVariable,
} from "../../base/styles/typography.styles";

const createHeadingStyles = () => css`
.${unsafeCSS(headingName)} {
  ${resetMargin()}
  ${defaultTypographyStyles()}
  ${fontSizeVariants()}
  ${fontFamilyVariants()}
  ${colorVariants()}
  ${lineHeightVariants()}
}`;

const fontSizeVariants = () =>
  unsafeCSS(
    headingSizes
      .flatMap(
        size =>
          `
&[data-size="${size}"] {
  ${setTypographyVariable("size", headingTokens.text.size[size])};
}`,
      )
      .join(""),
  );

const fontFamilyVariants = () =>
  unsafeCSS(
    headingFonts
      .flatMap(
        font =>
          `
&[data-font="${font}"] {
  ${setTypographyVariable("family", headingTokens.text.font[font])};
}`,
      )
      .join(""),
  );

const colorVariants = () =>
  unsafeCSS(
    headingColors
      .flatMap(
        color =>
          `
&[data-color="${color}"] {
${headingColorVariants
  .flatMap(
    colorVariant =>
      `
  &[data-color-variant="${colorVariant}"] {
    ${setTypographyVariable("color", headingTokens.text.color[color][colorVariant])};
  }`,
  )
  .join("")}
}`,
      )
      .join(""),
  );

const lineHeightVariants = () =>
  unsafeCSS(
    headingFonts
      .flatMap(
        font =>
          `
&[data-font="${font}"] {
  ${setTypographyVariable("family", headingTokens.text.font[font])};
  ${headingSizes
    .flatMap(
      size =>
        `
  &[data-size="${size}"] {
    ${setTypographyVariable("lineHeight", headingTokens.text["line-height"][font][size])};
  }`,
    )
    .join("")}
}`,
      )
      .join(""),
  );

export const headingStyles = createHeadingStyles();
